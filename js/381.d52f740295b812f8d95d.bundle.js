"use strict";
(self["webpackChunksmart_interact"] = self["webpackChunksmart_interact"] || []).push([[381],{

/***/ 90381:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": function() { return /* binding */ list; }
});

// EXTERNAL MODULE: ./src/@core/scss/react/apps/app-users.scss
var app_users = __webpack_require__(61360);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/defineProperty.js
var defineProperty = __webpack_require__(4942);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
var asyncToGenerator = __webpack_require__(15861);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules
var slicedToArray = __webpack_require__(70885);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/regenerator/index.js
var regenerator = __webpack_require__(64687);
var regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 13 modules
var es = __webpack_require__(95998);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/printer.js
var printer = __webpack_require__(60216);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/plus.js
var plus = __webpack_require__(61896);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/filter.js
var icons_filter = __webpack_require__(64811);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/chevron-down.js
var chevron_down = __webpack_require__(27434);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/chevron-up.js
var chevron_up = __webpack_require__(82802);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Row.js
var Row = __webpack_require__(10267);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Col.js
var Col = __webpack_require__(51252);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Button.js
var Button = __webpack_require__(97975);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Card.js
var Card = __webpack_require__(56941);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/CardHeader.js
var CardHeader = __webpack_require__(38089);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/CardTitle.js
var CardTitle = __webpack_require__(75351);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/CardBody.js
var CardBody = __webpack_require__(91121);
// EXTERNAL MODULE: ./src/@core/scss/react/libs/react-select/_react-select.scss
var _react_select = __webpack_require__(22299);
// EXTERNAL MODULE: ./src/@core/scss/react/libs/tables/react-dataTable-component.scss
var react_dataTable_component = __webpack_require__(73732);
// EXTERNAL MODULE: ./node_modules/react-toastify/dist/react-toastify.esm.mjs
var react_toastify_esm = __webpack_require__(55678);
// EXTERNAL MODULE: ./node_modules/react-intl/lib/src/components/message.js
var message = __webpack_require__(44012);
// EXTERNAL MODULE: ./node_modules/react-intl/lib/src/components/useIntl.js
var useIntl = __webpack_require__(86896);
// EXTERNAL MODULE: ./src/api/utlis.js
var utlis = __webpack_require__(16550);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/typeof.js
var esm_typeof = __webpack_require__(71002);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules
var toConsumableArray = __webpack_require__(42982);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/x.js
var x = __webpack_require__(78268);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/alert-octagon.js
var alert_octagon = __webpack_require__(61643);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/clock.js
var clock = __webpack_require__(90791);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/calendar.js
var calendar = __webpack_require__(91140);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/x-circle.js
var x_circle = __webpack_require__(13777);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Modal.js + 1 modules
var Modal = __webpack_require__(85677);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/ModalHeader.js
var ModalHeader = __webpack_require__(32701);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/ModalBody.js
var ModalBody = __webpack_require__(10684);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Alert.js
var Alert = __webpack_require__(17834);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Form.js
var Form = __webpack_require__(15538);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/FormGroup.js
var FormGroup = __webpack_require__(82669);
// EXTERNAL MODULE: ./src/views/customComponents/Field.js
var Field = __webpack_require__(48159);
// EXTERNAL MODULE: ./src/configs/api-urls.js
var api_urls = __webpack_require__(88295);
// EXTERNAL MODULE: ./src/redux/actions/layout/index.js
var layout = __webpack_require__(22974);
// EXTERNAL MODULE: ./src/views/customComponents/RouteSelect.js
var RouteSelect = __webpack_require__(77054);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js
var objectWithoutProperties = __webpack_require__(45987);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/edit-2.js
var edit_2 = __webpack_require__(55654);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/tag.js
var tag = __webpack_require__(31109);
// EXTERNAL MODULE: ./node_modules/react-feather/dist/icons/clipboard.js
var clipboard = __webpack_require__(70616);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/Label.js
var Label = __webpack_require__(67954);
// EXTERNAL MODULE: ./node_modules/reactstrap/es/ModalFooter.js
var ModalFooter = __webpack_require__(97985);
// EXTERNAL MODULE: ./src/utility/context/Can.js
var Can = __webpack_require__(6756);
// EXTERNAL MODULE: ./src/views/customComponents/Alert.js
var customComponents_Alert = __webpack_require__(16714);
// EXTERNAL MODULE: ./src/configs/actions.js
var actions = __webpack_require__(56176);
// EXTERNAL MODULE: ./src/configs/subjects.js
var subjects = __webpack_require__(14322);
// EXTERNAL MODULE: ./node_modules/react-select/dist/index-a7690a33.esm.js + 1 modules
var index_a7690a33_esm = __webpack_require__(39146);
// EXTERNAL MODULE: ./node_modules/react-select/dist/react-select.esm.js + 2 modules
var react_select_esm = __webpack_require__(39544);
// EXTERNAL MODULE: ./src/utility/Utils.js
var Utils = __webpack_require__(16724);
// EXTERNAL MODULE: ./src/utility/hooks/useSkin.js
var useSkin = __webpack_require__(47201);
// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(30381);
var moment_default = /*#__PURE__*/__webpack_require__.n(moment);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(85893);
;// CONCATENATED MODULE: ./src/views/customComponents/CarSelect.js




var _excluded = ["data"];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0,defineProperty/* default */.Z)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }





















var CarSelect = function CarSelect(_ref) {
  var refresh = _ref.refresh,
      dispatch = _ref.dispatch,
      acc = _ref.acc,
      onChange = _ref.onChange,
      requireStar = _ref.requireStar,
      invalid = _ref.invalid,
      invalidText = _ref.invalidText,
      edit = _ref.edit,
      add = _ref.add,
      label = _ref.label,
      disabled = _ref.disabled;

  var _useState = (0,react.useState)(false),
      _useState2 = (0,slicedToArray/* default */.Z)(_useState, 2),
      submittedCar = _useState2[0],
      setSubmittedCar = _useState2[1];

  var _useState3 = (0,react.useState)(null),
      _useState4 = (0,slicedToArray/* default */.Z)(_useState3, 2),
      errorCar = _useState4[0],
      setErrorCar = _useState4[1];

  var _useState5 = (0,react.useState)(false),
      _useState6 = (0,slicedToArray/* default */.Z)(_useState5, 2),
      openCar = _useState6[0],
      setOpenCar = _useState6[1];

  var _useState7 = (0,react.useState)([]),
      _useState8 = (0,slicedToArray/* default */.Z)(_useState7, 2),
      cars = _useState8[0],
      setCars = _useState8[1];

  var _useState9 = (0,react.useState)([]),
      _useState10 = (0,slicedToArray/* default */.Z)(_useState9, 2),
      carFetched = _useState10[0],
      setCarFetched = _useState10[1];

  var ability = (0,react.useContext)(Can/* AbilityContext */.v);

  var _useState11 = (0,react.useState)(null),
      _useState12 = (0,slicedToArray/* default */.Z)(_useState11, 2),
      carSelected = _useState12[0],
      setCarSelected = _useState12[1];

  var _useState13 = (0,react.useState)({}),
      _useState14 = (0,slicedToArray/* default */.Z)(_useState13, 2),
      car = _useState14[0],
      setCar = _useState14[1];

  var _useSkin = (0,useSkin/* useSkin */.Q)(),
      _useSkin2 = (0,slicedToArray/* default */.Z)(_useSkin, 1),
      skin = _useSkin2[0];

  var intl = (0,useIntl/* default */.Z)();

  var _useState15 = (0,react.useState)(0),
      _useState16 = (0,slicedToArray/* default */.Z)(_useState15, 2),
      timer = _useState16[0],
      setTimer = _useState16[1];

  var onEditCar = function onEditCar() {
    var c = cars.find(function (c) {
      return c.value === Number(carSelected.value);
    });

    if (c) {
      (0,utlis/* apiCall */.k_)(utlis/* get */.U2, [api_urls/* CAR_URL */.ko, c.value], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (data) {
        setCar(data);
        setOpenCar(true);
      }, null);
    }
  };

  var OptionComponent = function OptionComponent(_ref2) {
    var data = _ref2.data,
        props = (0,objectWithoutProperties/* default */.Z)(_ref2, _excluded);

    if (data.type === "add-car") {
      return /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default */.Z, {
        className: "text-left rounded-0",
        color: data.color,
        block: true,
        onClick: function onClick() {
          return setOpenCar(true);
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(plus/* default */.Z, {
          size: 14
        }), " ", /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "align-middle ml-50",
          children: data.label
        })]
      });
    } else if (data.type === "edit-car") {
      return /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default */.Z, {
        className: "text-left rounded-0",
        color: data.color,
        block: true,
        onClick: function onClick() {
          return onEditCar();
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(edit_2/* default */.Z, {
          size: 14
        }), " ", /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "align-middle ml-50",
          children: data.label
        })]
      });
    } else {
      return /*#__PURE__*/(0,jsx_runtime.jsx)(index_a7690a33_esm.c.Option, _objectSpread(_objectSpread({}, props), {}, {
        children: /*#__PURE__*/(0,jsx_runtime.jsx)("strong", {
          children: data.label
        })
      }));
    }
  };

  var onCarClosed = function onCarClosed() {
    setSubmittedCar(false);
    setOpenCar(false);
    setCar({});
    setErrorCar("");
  };

  function handleCarsFetched(data, id) {
    setCarFetched(data);
    var list = data.map(function (c) {
      return {
        value: c.id,
        label: c.name,
        description: c.description,
        start: c.start,
        end: c.end
      };
    });

    if (id && list.length > 0) {
      onCarChange(list[0]);
    }

    if (edit && carSelected && ability.can(actions/* ACTIONS.EDIT_ACTION */.a.EDIT_ACTION, subjects/* SUBJECTS.CAR_SUBJECT */.k.CAR_SUBJECT)) {
      list = [{
        value: "edit-car",
        label: intl.formatMessage({
          id: "editCar"
        }),
        type: "edit-car",
        color: "flat-warning"
      }].concat((0,toConsumableArray/* default */.Z)(list));
    }

    if (add && ability.can(actions/* ACTIONS.WRITE_ACTION */.a.WRITE_ACTION, subjects/* SUBJECTS.CAR_SUBJECT */.k.CAR_SUBJECT)) {
      list = [{
        value: "add-car",
        label: intl.formatMessage({
          id: "addCar"
        }),
        type: "add-car",
        color: "flat-success"
      }].concat((0,toConsumableArray/* default */.Z)(list));
    }

    setCars(list);
  }

  var getCars = function getCars(id) {
    (0,utlis/* apiCall */.k_)(utlis/* getAll */.go, [!id ? api_urls/* CARS_URL */.QE : api_urls/* CARS_URL */.QE + "?id=" + id], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (res) {
      return handleCarsFetched(res, id);
    }, null);
  };

  var onCarSuccess = function onCarSuccess(_ref3) {
    var id = _ref3.id;
    setOpenCar(false);
    setCarSelected(null);
    onChange(null);
    getCars(id);
  };

  var deleteCar = function deleteCar() {
    (0,customComponents_Alert/* SweetAlert */.o)(intl.formatMessage({
      id: "delete"
    }), intl.formatMessage({
      id: "deleteCarQuestion"
    }), "warning", true, intl.formatMessage({
      id: "yes"
    }), intl.formatMessage({
      id: "no"
    })).then(function (res) {
      if (res.value) {
        (0,utlis/* apiCall */.k_)(utlis/* update */.Vx, [api_urls/* CAR_URL */.ko, car.id, {
          deleted: true
        }], true, react_toastify_esm/* toast */.Am, dispatch, "carDeletedSuccessfully", "somethingWrong", onCarSuccess, null);
      }
    });
  };

  (0,react.useEffect)(function () {
    setCarSelected(acc);
  }, [acc]);
  (0,react.useEffect)(function () {
    if (refresh) {
      getCars();
    }
  }, [refresh]);

  var onCarChange = function onCarChange(e) {
    setCarSelected(e);
    onChange(e);
  };

  var onCarFail = function onCarFail(err) {
    if (err.code === 414) {
      setErrorCar("nameExist");
    } else if (err.code === 415) {
      setErrorCar("carDateOverlap");
    } else {
      setErrorCar("somethingWrong");
    }
  };

  var saveCar = function saveCar(e) {
    e.preventDefault();
    setErrorCar(false);
    setSubmittedCar(true);

    if (car.name) {
      if (car.id) {
        (0,utlis/* apiCall */.k_)(utlis/* update */.Vx, [api_urls/* CAR_URL */.ko, car.id, car], true, react_toastify_esm/* toast */.Am, dispatch, "carUpdatedSuccessfully", "", onCarSuccess, onCarFail);
      } else {
        (0,utlis/* apiCall */.k_)(utlis/* insert */.$T, [api_urls/* CAR_URL */.ko, car], true, react_toastify_esm/* toast */.Am, dispatch, "carCreatedSuccessfully", "", onCarSuccess, onCarFail);
      }
    }
  };

  var filter = function filter(val) {
    if (val) {
      clearTimeout(timer);
      setTimer(setTimeout(function () {
        (0,utlis/* apiCall */.k_)(utlis/* getAllPaged */.Ki, [api_urls/* CARS_URL */.QE, 0, 20, [["name", "asc"]], {
          name: val
        }], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (data) {
          return handleCarsFetched(data);
        }, null);
      }, 700));
    }
  };

  return /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
    children: [/*#__PURE__*/(0,jsx_runtime.jsxs)(FormGroup/* default */.Z, {
      children: [label !== false && /*#__PURE__*/(0,jsx_runtime.jsxs)(Label/* default */.Z, {
        for: "car",
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
          id: "car"
        }), " ", requireStar ? /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "text-danger h6",
          children: "*"
        }) : ""]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
        style: {
          border: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid 1px"),
          borderRadius: "5px",
          display: "flex",
          alignItems: "center"
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)("i", {
          className: "fa-solid fa-van-shuttle mx-1"
        }), " ", /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
          style: {
            flexGrow: 1,
            borderLeft: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid ").concat(intl.locale === "ar" ? "0px" : "1px"),
            borderRight: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid ").concat(intl.locale === "ar" ? "1px" : "0px")
          },
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(react_select_esm/* default */.ZP, {
            isDisabled: disabled,
            styles: {
              control: function control(provided) {
                return _objectSpread(_objectSpread({}, provided), {}, {
                  border: "none"
                });
              }
            },
            onMenuOpen: function onMenuOpen() {
              return handleCarsFetched(carFetched);
            },
            id: "car",
            placeholder: intl.formatMessage({
              id: "selectCar"
            }),
            value: carSelected,
            components: {
              Option: OptionComponent
            },
            noOptionsMessage: function noOptionsMessage() {
              return /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "noRecords"
              });
            },
            onChange: function onChange(e) {
              return onCarChange(e);
            },
            isClearable: true,
            theme: Utils/* selectThemeColors */.ss,
            options: cars,
            classNamePrefix: "select",
            onInputChange: function onInputChange(v) {
              return filter(v);
            }
          })
        })]
      }), invalid && /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
        className: "customSelectError",
        children: invalidText
      })]
    }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Modal/* default */.Z, {
      autoFocus: false,
      isOpen: openCar,
      toggle: function toggle() {
        return setOpenCar(!openCar);
      },
      onClosed: onCarClosed,
      className: "modal-dialog-centered",
      children: [/*#__PURE__*/(0,jsx_runtime.jsx)(ModalHeader/* default */.Z, {
        toggle: function toggle() {
          return setOpenCar(!openCar);
        },
        children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
          id: car.id ? "editCar" : "addCar"
        })
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(ModalBody/* default */.Z, {
        children: [errorCar && /*#__PURE__*/(0,jsx_runtime.jsxs)(Alert/* default */.Z, {
          color: "danger",
          className: "d-flex align-items-center",
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
            className: "alert-body font-small-2 flex-grow-1",
            children: /*#__PURE__*/(0,jsx_runtime.jsx)("p", {
              children: /*#__PURE__*/(0,jsx_runtime.jsx)("small", {
                className: "mr-50",
                children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                  id: errorCar
                })
              })
            })
          }), /*#__PURE__*/(0,jsx_runtime.jsx)(alert_octagon/* default */.Z, {
            id: "login-tip",
            className: "mx-50",
            size: 18,
            style: {
              top: "10px",
              right: "10px"
            }
          })]
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
          autoFocus: true,
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "name"
          }),
          value: car.name,
          id: "name",
          name: "name",
          placeholder: "",
          requireStar: true,
          onChange: function onChange(e) {
            return setCar(_objectSpread(_objectSpread({}, car), {}, {
              name: e.target.value
            }));
          },
          invalid: submittedCar && !car.name,
          invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "required"
          }),
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.Z, {
              size: 14
            })
          }
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "description"
          }),
          value: car.description,
          id: "description",
          type: "textarea",
          name: "description",
          placeholder: "",
          onChange: function onChange(e) {
            return setCar(_objectSpread(_objectSpread({}, car), {}, {
              description: e.target.value
            }));
          },
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)(clipboard/* default */.Z, {
              size: 14
            })
          }
        })]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(ModalFooter/* default */.Z, {
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
          onClick: saveCar,
          color: "primary",
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "save"
          })
        }), car.id && ability.can(actions/* ACTIONS.DELETE_ACTION */.a.DELETE_ACTION, subjects/* SUBJECTS.CAR_SUBJECT */.k.CAR_SUBJECT) && /*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
          color: "danger",
          type: "button",
          onClick: deleteCar,
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "delete"
          })
        })]
      })]
    })]
  });
};

/* harmony default export */ var customComponents_CarSelect = (CarSelect);
// EXTERNAL MODULE: ./src/@core/components/avatar/index.js
var avatar = __webpack_require__(68138);
// EXTERNAL MODULE: ./src/assets/images/avatars/avatar-blank.png
var avatar_blank = __webpack_require__(76930);
// EXTERNAL MODULE: ./src/configs/acl/roles.js
var roles = __webpack_require__(71107);
;// CONCATENATED MODULE: ./src/views/customComponents/DriverSelect.js




var DriverSelect_excluded = ["data"];

function DriverSelect_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function DriverSelect_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? DriverSelect_ownKeys(Object(source), !0).forEach(function (key) { (0,defineProperty/* default */.Z)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : DriverSelect_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
























var DriverSelect = function DriverSelect(_ref) {
  var refresh = _ref.refresh,
      dispatch = _ref.dispatch,
      acc = _ref.acc,
      onChange = _ref.onChange,
      requireStar = _ref.requireStar,
      invalid = _ref.invalid,
      invalidText = _ref.invalidText,
      edit = _ref.edit,
      add = _ref.add,
      label = _ref.label,
      disabled = _ref.disabled;

  var _useState = (0,react.useState)(false),
      _useState2 = (0,slicedToArray/* default */.Z)(_useState, 2),
      submittedDriver = _useState2[0],
      setSubmittedDriver = _useState2[1];

  var _useState3 = (0,react.useState)(null),
      _useState4 = (0,slicedToArray/* default */.Z)(_useState3, 2),
      errorDriver = _useState4[0],
      setErrorDriver = _useState4[1];

  var _useState5 = (0,react.useState)(false),
      _useState6 = (0,slicedToArray/* default */.Z)(_useState5, 2),
      openDriver = _useState6[0],
      setOpenDriver = _useState6[1];

  var _useState7 = (0,react.useState)([]),
      _useState8 = (0,slicedToArray/* default */.Z)(_useState7, 2),
      drivers = _useState8[0],
      setDrivers = _useState8[1];

  var _useState9 = (0,react.useState)([]),
      _useState10 = (0,slicedToArray/* default */.Z)(_useState9, 2),
      driverFetched = _useState10[0],
      setDriverFetched = _useState10[1];

  var ability = (0,react.useContext)(Can/* AbilityContext */.v);

  var _useState11 = (0,react.useState)(null),
      _useState12 = (0,slicedToArray/* default */.Z)(_useState11, 2),
      driverSelected = _useState12[0],
      setDriverSelected = _useState12[1];

  var _useState13 = (0,react.useState)({}),
      _useState14 = (0,slicedToArray/* default */.Z)(_useState13, 2),
      driver = _useState14[0],
      setDriver = _useState14[1];

  var _useSkin = (0,useSkin/* useSkin */.Q)(),
      _useSkin2 = (0,slicedToArray/* default */.Z)(_useSkin, 1),
      skin = _useSkin2[0];

  var intl = (0,useIntl/* default */.Z)();

  var _useState15 = (0,react.useState)(0),
      _useState16 = (0,slicedToArray/* default */.Z)(_useState15, 2),
      timer = _useState16[0],
      setTimer = _useState16[1];

  var onEditDriver = function onEditDriver() {
    var c = drivers.find(function (c) {
      return c.value === Number(driverSelected.value);
    });

    if (c) {
      (0,utlis/* apiCall */.k_)(utlis/* get */.U2, [api_urls/* USER_URL */.uh, c.value], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (data) {
        setDriver(data);
        setOpenDriver(true);
      }, null);
    }
  };

  var OptionComponent = function OptionComponent(_ref2) {
    var data = _ref2.data,
        props = (0,objectWithoutProperties/* default */.Z)(_ref2, DriverSelect_excluded);

    if (data.type === "add-driver") {
      return /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default */.Z, {
        className: "text-left rounded-0",
        color: data.color,
        block: true,
        onClick: function onClick() {
          return setOpenDriver(true);
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(plus/* default */.Z, {
          size: 14
        }), " ", /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "align-middle ml-50",
          children: data.label
        })]
      });
    } else if (data.type === "edit-driver") {
      return /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default */.Z, {
        className: "text-left rounded-0",
        color: data.color,
        block: true,
        onClick: function onClick() {
          return onEditDriver();
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(edit_2/* default */.Z, {
          size: 14
        }), " ", /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "align-middle ml-50",
          children: data.label
        })]
      });
    } else {
      return /*#__PURE__*/(0,jsx_runtime.jsx)(index_a7690a33_esm.c.Option, DriverSelect_objectSpread(DriverSelect_objectSpread({}, props), {}, {
        children: /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
          className: "d-flex flex-wrap align-items-center zindex-dropdown",
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.Z, {
            className: "my-0 mr-50",
            size: "sm",
            img: data.avatar || avatar_blank
          }), /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
            className: "d-flex  flex-column justify-content-start",
            children: [/*#__PURE__*/(0,jsx_runtime.jsx)("strong", {
              children: data.label
            }), /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
              children: data.username
            })]
          })]
        })
      }));
    }
  };

  var onDriverClosed = function onDriverClosed() {
    setSubmittedDriver(false);
    setOpenDriver(false);
    setDriver({});
    setErrorDriver("");
  };

  function handleDriversFetched(data) {
    setDriverFetched(data);
    var list = data.map(function (c) {
      return {
        value: c.staffId,
        label: c.name,
        username: c.username,
        avatar: c.avatar
      };
    });

    if (edit && driverSelected && ability.can(actions/* ACTIONS.EDIT_ACTION */.a.EDIT_ACTION, subjects/* SUBJECTS.USER_SUBJECT */.k.USER_SUBJECT)) {
      list = [{
        value: "edit-driver",
        label: intl.formatMessage({
          id: "editDriver"
        }),
        type: "edit-driver",
        color: "flat-warning"
      }].concat((0,toConsumableArray/* default */.Z)(list));
    }

    if (add && ability.can(actions/* ACTIONS.WRITE_ACTION */.a.WRITE_ACTION, subjects/* SUBJECTS.USER_SUBJECT */.k.USER_SUBJECT)) {
      list = [{
        value: "add-driver",
        label: intl.formatMessage({
          id: "addDriver"
        }),
        type: "add-driver",
        color: "flat-success"
      }].concat((0,toConsumableArray/* default */.Z)(list));
    }

    setDrivers(list);
  }

  var getDrivers = function getDrivers() {
    (0,utlis/* apiCall */.k_)(utlis/* getAllPaged */.Ki, [api_urls/* USERS_URL */.Gm, 0, 20, [["name", "asc"]], {
      role: roles/* ROLES.DRIVER_ROLE */.K.DRIVER_ROLE
    }], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (data) {
      return handleDriversFetched(data.rows);
    }, null);
  };

  var onDriverSuccess = function onDriverSuccess() {
    setOpenDriver(false);
    setDriverSelected(null);
    onChange(null);
    getDrivers();
  };

  var deleteDriver = function deleteDriver() {
    (0,customComponents_Alert/* SweetAlert */.o)(intl.formatMessage({
      id: "delete"
    }), intl.formatMessage({
      id: "deleteDriverQuestion"
    }), "warning", true, intl.formatMessage({
      id: "yes"
    }), intl.formatMessage({
      id: "no"
    })).then(function (res) {
      if (res.value) {
        (0,utlis/* apiCall */.k_)(utlis/* update */.Vx, [api_urls/* USER_URL */.uh, driver.id, {
          deleted: true
        }], true, react_toastify_esm/* toast */.Am, dispatch, "driverDeletedSuccessfully", "somethingWrong", onDriverSuccess, null);
      }
    });
  };

  (0,react.useEffect)(function () {
    setDriverSelected(acc);
  }, [acc]);
  (0,react.useEffect)(function () {
    if (refresh) {
      getDrivers();
    }
  }, [refresh]);

  var onDriverChange = function onDriverChange(e) {
    setDriverSelected(e);
    onChange(e);
  };

  var onDriverFail = function onDriverFail(err) {
    if (err.code === 414) {
      setErrorDriver("nameExist");
    } else if (err.code === 415) {
      setErrorDriver("driverDateOverlap");
    } else {
      setErrorDriver("somethingWrong");
    }
  };

  var saveDriver = function saveDriver(e) {
    e.preventDefault();
    setErrorDriver(false);
    setSubmittedDriver(true);

    if (driver.name && driver.dob && driver.gender) {
      driver.role = roles/* ROLES.DRIVER_ROLE */.K.DRIVER_ROLE;

      if (driver.id) {
        (0,utlis/* apiCall */.k_)(utlis/* update */.Vx, [api_urls/* USER_URL */.uh, driver.id, driver], true, react_toastify_esm/* toast */.Am, dispatch, "driverUpdatedSuccessfully", "", onDriverSuccess, onDriverFail);
      } else {
        (0,utlis/* apiCall */.k_)(utlis/* insert */.$T, [api_urls/* USER_URL */.uh, driver], true, react_toastify_esm/* toast */.Am, dispatch, "driverCreatedSuccessfully", "", onDriverSuccess, onDriverFail);
      }
    }
  };

  var filter = function filter(val) {
    if (val) {
      clearTimeout(timer);
      setTimer(setTimeout(function () {
        (0,utlis/* apiCall */.k_)(utlis/* getAllPaged */.Ki, [api_urls/* USERS_URL */.Gm, 0, 20, [["name", "asc"]], {
          name: val
        }], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", function (data) {
          return handleDriversFetched(data.rows);
        }, null);
      }, 700));
    }
  };

  return /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
    children: [/*#__PURE__*/(0,jsx_runtime.jsxs)(FormGroup/* default */.Z, {
      children: [label !== false && /*#__PURE__*/(0,jsx_runtime.jsxs)(Label/* default */.Z, {
        for: "driver",
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
          id: "driver"
        }), " ", requireStar ? /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
          className: "text-danger h6",
          children: "*"
        }) : ""]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
        style: {
          border: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid 1px"),
          borderRadius: "5px",
          display: "flex",
          alignItems: "center"
        },
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)("i", {
          className: "fa-solid fa-user-tie mx-1"
        }), /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
          style: {
            flexGrow: 1,
            borderLeft: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid ").concat(intl.locale === "ar" ? "0px" : "1px"),
            borderRight: "".concat(invalid ? "#dc3545" : skin === "dark" ? "#404656" : "#d8d6de", " solid ").concat(intl.locale === "ar" ? "1px" : "0px")
          },
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(react_select_esm/* default */.ZP, {
            isDisabled: disabled,
            styles: {
              control: function control(provided) {
                return DriverSelect_objectSpread(DriverSelect_objectSpread({}, provided), {}, {
                  border: "none"
                });
              }
            },
            onMenuOpen: function onMenuOpen() {
              return handleDriversFetched(driverFetched);
            },
            id: "driver",
            placeholder: intl.formatMessage({
              id: "selectDriver"
            }),
            value: driverSelected,
            components: {
              Option: OptionComponent
            },
            noOptionsMessage: function noOptionsMessage() {
              return /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "noRecords"
              });
            },
            onChange: function onChange(e) {
              return onDriverChange(e);
            },
            isClearable: true,
            theme: Utils/* selectThemeColors */.ss,
            options: drivers,
            classNamePrefix: "select",
            onInputChange: function onInputChange(v) {
              return filter(v);
            }
          })
        })]
      }), invalid && /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
        className: "customSelectError",
        children: invalidText
      })]
    }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Modal/* default */.Z, {
      autoFocus: false,
      isOpen: openDriver,
      toggle: function toggle() {
        return setOpenDriver(!openDriver);
      },
      onClosed: onDriverClosed,
      className: "modal-dialog-centered",
      children: [/*#__PURE__*/(0,jsx_runtime.jsx)(ModalHeader/* default */.Z, {
        toggle: function toggle() {
          return setOpenDriver(!openDriver);
        },
        children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
          id: driver.id ? "editDriver" : "addDriver"
        })
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(ModalBody/* default */.Z, {
        children: [errorDriver && /*#__PURE__*/(0,jsx_runtime.jsxs)(Alert/* default */.Z, {
          color: "danger",
          className: "d-flex align-items-center",
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
            className: "alert-body font-small-2 flex-grow-1",
            children: /*#__PURE__*/(0,jsx_runtime.jsx)("p", {
              children: /*#__PURE__*/(0,jsx_runtime.jsx)("small", {
                className: "mr-50",
                children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                  id: errorDriver
                })
              })
            })
          }), /*#__PURE__*/(0,jsx_runtime.jsx)(alert_octagon/* default */.Z, {
            id: "login-tip",
            className: "mx-50",
            size: 18,
            style: {
              top: "10px",
              right: "10px"
            }
          })]
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
          autoFocus: true,
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "name"
          }),
          value: driver.name,
          id: "name",
          name: "name",
          placeholder: "",
          requireStar: true,
          onChange: function onChange(e) {
            return setDriver(DriverSelect_objectSpread(DriverSelect_objectSpread({}, driver), {}, {
              name: e.target.value
            }));
          },
          invalid: submittedDriver && !driver.name,
          invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "required"
          }),
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.Z, {
              size: 14
            })
          }
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "dob"
          }),
          id: "dob",
          name: "dob",
          className: "form-control",
          onChange: function onChange(date) {
            return setDriver(DriverSelect_objectSpread(DriverSelect_objectSpread({}, driver), {}, {
              dob: date[0]
            }));
          },
          value: driver.dob,
          invalid: submittedDriver && !driver.dob,
          requireStar: true,
          invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "required"
          }),
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)(calendar/* default */.Z, {
              size: 14
            })
          },
          type: "flatPicker"
        }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Field/* default */.Z, {
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "gender"
          }),
          type: "select",
          id: "select-plan",
          name: "select-plan",
          value: driver.gender,
          onChange: function onChange(e) {
            return setDriver(DriverSelect_objectSpread(DriverSelect_objectSpread({}, driver), {}, {
              gender: e.target.value
            }));
          },
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)("i", {
              className: "fa-solid fa-venus-mars"
            })
          },
          requireStar: true,
          invalid: submittedDriver && !driver.gender,
          invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "required"
          }),
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)("option", {
            value: "",
            children: intl.formatMessage({
              id: "selectGender"
            })
          }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
            value: "male",
            children: intl.formatMessage({
              id: "male"
            })
          }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
            value: "female",
            children: intl.formatMessage({
              id: "female"
            })
          })]
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
          label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "note"
          }),
          value: driver.note,
          id: "note",
          type: "textarea",
          name: "note",
          placeholder: "",
          onChange: function onChange(e) {
            return setDriver(DriverSelect_objectSpread(DriverSelect_objectSpread({}, driver), {}, {
              note: e.target.value
            }));
          },
          prepend: {
            icon: /*#__PURE__*/(0,jsx_runtime.jsx)(clipboard/* default */.Z, {
              size: 14
            })
          }
        })]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(ModalFooter/* default */.Z, {
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
          onClick: saveDriver,
          color: "primary",
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "save"
          })
        }), driver.id && ability.can(actions/* ACTIONS.DELETE_ACTION */.a.DELETE_ACTION, subjects/* SUBJECTS.USER_SUBJECT */.k.USER_SUBJECT) && /*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
          color: "danger",
          type: "button",
          onClick: deleteDriver,
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
            id: "delete"
          })
        })]
      })]
    })]
  });
};

/* harmony default export */ var customComponents_DriverSelect = (DriverSelect);
;// CONCATENATED MODULE: ./src/views/apps/schedule/list/Sidebar.js






















var Sidebar = function Sidebar(props) {
  var open = props.open,
      toggleSidebar = props.toggleSidebar,
      refresh = props.refresh,
      schedule = props.schedule,
      onClosed = props.onClosed,
      dispatch = props.dispatch;

  var _useState = (0,react.useState)(false),
      _useState2 = (0,slicedToArray/* default */.Z)(_useState, 2),
      submitted = _useState2[0],
      setSubmitted = _useState2[1];

  var _useState3 = (0,react.useState)(schedule.route || null),
      _useState4 = (0,slicedToArray/* default */.Z)(_useState3, 2),
      route = _useState4[0],
      setRoute = _useState4[1];

  var _useState5 = (0,react.useState)(schedule.schedules || []),
      _useState6 = (0,slicedToArray/* default */.Z)(_useState5, 2),
      schedules = _useState6[0],
      setSchedules = _useState6[1];

  var intl = (0,useIntl/* default */.Z)();

  var _useState7 = (0,react.useState)(null),
      _useState8 = (0,slicedToArray/* default */.Z)(_useState7, 2),
      error = _useState8[0],
      setError = _useState8[1];

  var onClose = function onClose() {
    setSubmitted(false);
    onClosed();
    setRoute(null);
    setError(null);
    setSchedules([]);
  };

  var handleSchedulesFetched = function handleSchedulesFetched(res) {
    setRoute(res.route);
    setSchedules([{
      time: res.time,
      day: res.day,
      car: res.car,
      carName: res.carName,
      driverName: res.driverName,
      driver: res.driver
    }]);
  };

  var initSchedule = function initSchedule() {
    if (schedule.id) {
      (0,utlis/* apiCall */.k_)(utlis/* get */.U2, [api_urls/* SCHEDULE_URL */.bc, schedule.id], true, react_toastify_esm/* toast */.Am, dispatch, "", "somethingWrong", handleSchedulesFetched, toggleSidebar);
    }
  };

  (0,react.useEffect)(function () {
    if (open) {
      initSchedule();
    }
  }, [open]);
  var isSaveButtonDisabled = !route;

  var onScheduleSuccess = function onScheduleSuccess() {
    toggleSidebar();
    refresh();
  };

  var onCreate = function onCreate(e) {
    e.preventDefault();
    setSubmitted(true);

    if (!isSaveButtonDisabled) {
      if (!schedules.length || schedules.some(function (t) {
        return !t.day || !t.time || !t.car || !t.driver;
      })) {
        setError("timesMissing");
        return;
      }

      (0,utlis/* apiCall */.k_)(utlis/* insert */.$T, [api_urls/* SCHEDULE_URL */.bc, {
        route: route,
        schedules: schedules
      }], true, react_toastify_esm/* toast */.Am, dispatch, "scheduleCreatedSuccessfully", "", onScheduleSuccess, onFail);
    }
  };

  var onUpdate = function onUpdate(e) {
    e.preventDefault();
    setSubmitted(true);

    if (!isSaveButtonDisabled) {
      if (!schedules.length || schedules.some(function (t) {
        return !t.day || !t.time || !t.car || !t.driver;
      })) {
        setError("timesMissing");
        return;
      }

      (0,utlis/* apiCall */.k_)(utlis/* update */.Vx, [api_urls/* SCHEDULE_URL */.bc, schedule.id, {
        route: route,
        car: schedules[0].car,
        driver: schedules[0].driver,
        time: moment_default()(schedules[0].time).format("YYYY-MM-DD HH:mm"),
        day: schedules[0].day
      }], true, react_toastify_esm/* toast */.Am, dispatch, "scheduleUpdatedSuccessfully", "", onScheduleSuccess, onFail);
    }
  };

  var onFail = function onFail(err) {
    dispatch((0,layout/* handleLoader */.EV)(false));

    if (err.code === 414) {
      setError("timeExist");
    } else {
      setError("somethingWrong");
    }
  };

  var isAvailable = function isAvailable(t, day, car, driver, i) {
    var query = schedule.id ? "?id=" + schedule.id : "";

    if (typeof t === "string" && t.length) {
      var h = Number(t.split(":")[0]);
      var m = Number(t.split(":")[1]);
      var date = new Date();
      date.setHours(h);
      date.setMinutes(m);
      t = date;
    }

    (0,utlis/* apiCall */.k_)(utlis/* insert */.$T, [api_urls/* SCHEDULE_AVAILABLE_URL */.DA + query, {
      day: day,
      time: t,
      car: car,
      route: route,
      driver: driver
    }], true, react_toastify_esm/* toast */.Am, dispatch, null, "", function () {
      schedules[i].time = t;
      schedules[i].day = day;
      schedules[i].car = car;
      schedules[i].driver = driver;
      setSchedules(function () {
        return (0,toConsumableArray/* default */.Z)(schedules);
      });
    }, function (e) {
      setError(e.code === 414 ? "timeExist" : "somethingWrong");
      schedules[i].time = "";
      setSchedules(function () {
        return (0,toConsumableArray/* default */.Z)(schedules);
      });
    });
  };

  var handleDay = function handleDay(i, v) {
    var exist = schedules.find(function (t) {
      return t.id !== schedules[i].id && t.car === schedules[i].car && t.driver === schedules[i].driver && t.day === v && t.time && schedules[i].time && t.time.getHours() === schedules[i].time.getHours() && t.time.getMinutes() === schedules[i].time.getMinutes();
    });
    setError("");
    schedules[i].day = v;
    setSchedules(function () {
      return (0,toConsumableArray/* default */.Z)(schedules);
    });

    if (v && schedules[i].time && schedules[i].car && schedules[i].driver) {
      if (exist) {
        setError("timeExist");
        schedules[i].day = "";
        setSchedules(function () {
          return (0,toConsumableArray/* default */.Z)(schedules);
        });
      } else {
        isAvailable(schedules[i].time, v, schedules[i].car, schedules[i].driver, i);
      }
    }
  };

  var handleDriver = function handleDriver(i, v, label) {
    var exist = schedules.find(function (t) {
      return t.id !== schedules[i].id && t.car === schedules[i].car && t.driver === v && t.day === schedules[i].day && t.time && schedules[i].time && t.time.getHours() === schedules[i].time.getHours() && t.time.getMinutes() === schedules[i].time.getMinutes();
    });
    setError("");
    schedules[i].driver = v;
    schedules[i].driverName = label;
    setSchedules(function () {
      return (0,toConsumableArray/* default */.Z)(schedules);
    });

    if (v && schedules[i].time && schedules[i].car && schedules[i].day) {
      if (exist) {
        setError("timeExist");
        schedules[i].driver = null;
        schedules[i].driverName = null;
        setSchedules(function () {
          return (0,toConsumableArray/* default */.Z)(schedules);
        });
      } else {
        isAvailable(schedules[i].time, schedules[i].day, schedules[i].car, v, i);
      }
    }
  };

  var handleCar = function handleCar(i, v, label) {
    var exist = schedules.find(function (t) {
      return t.id !== schedules[i].id && t.car === v && t.driver === schedules[i].driver && t.day === schedules[i].day && t.time && schedules[i].time && t.time.getHours() === schedules[i].time.getHours() && t.time.getMinutes() === schedules[i].time.getMinutes();
    });
    setError("");
    schedules[i].car = v;
    schedules[i].carName = label;
    setSchedules(function () {
      return (0,toConsumableArray/* default */.Z)(schedules);
    });

    if (v && schedules[i].time && schedules[i].driver && schedules[i].day) {
      if (exist) {
        setError("timeExist");
        schedules[i].car = null;
        schedules[i].carName = null;
        setSchedules(function () {
          return (0,toConsumableArray/* default */.Z)(schedules);
        });
      } else {
        isAvailable(schedules[i].time, schedules[i].day, v, schedules[i].driver, i);
      }
    }
  };

  var handleTime = function handleTime(i, v) {
    if (!v) {
      return;
    }

    var exist = schedules.find(function (t) {
      return t.id !== schedules[i].id && t.car === schedules[i].car && t.driver === schedules[i].driver && t.day === schedules[i].day && t.time && t.time.getHours() === v.getHours() && t.time.getMinutes() === v.getMinutes();
    });
    setError("");
    schedules[i].time = v;
    setSchedules(function () {
      return (0,toConsumableArray/* default */.Z)(schedules);
    });

    if (v && schedules[i].car && schedules[i].driver && schedules[i].day) {
      if (exist) {
        setError("timeExist");
        schedules[i].time = "";
        setSchedules(function () {
          return (0,toConsumableArray/* default */.Z)(schedules);
        });
      } else {
        isAvailable(v, schedules[i].day, schedules[i].car, schedules[i].driver, i);
      }
    }
  };

  var deleteSchedule = function deleteSchedule(i) {
    schedules.splice(i, 1);
    setSchedules(function () {
      return (0,toConsumableArray/* default */.Z)(schedules);
    });
  };

  var onRouteChange = function onRouteChange(e) {
    setRoute(e === null || e === void 0 ? void 0 : e.value);
  };

  var onDeleteSchedule = function onDeleteSchedule() {
    (0,customComponents_Alert/* SweetAlert */.o)(intl.formatMessage({
      id: "delete"
    }), intl.formatMessage({
      id: "deleteScheduleQuestion"
    }), "warning", true, intl.formatMessage({
      id: "yes"
    }), intl.formatMessage({
      id: "no"
    })).then(function (res) {
      if (res.value) {
        (0,utlis/* apiCall */.k_)(utlis/* remove */.Od, [api_urls/* SCHEDULE_URL */.bc, schedule.id], true, react_toastify_esm/* toast */.Am, dispatch, "scheduleDeletedSuccessfully", "somethingWrong", onScheduleSuccess, null);
      }
    });
  };

  var getDate = function getDate(t) {
    if (typeof t === "string") {
      var date = new Date();
      var hours = Number(t.split(":")[0]);
      var minutes = Number(t.split(":")[1]);
      date.setHours(hours);
      date.setMinutes(minutes);
      return date;
    } else if ((0,esm_typeof/* default */.Z)(t) === "object") {
      return t;
    }

    return null;
  };

  return /*#__PURE__*/(0,jsx_runtime.jsxs)(Modal/* default */.Z, {
    isOpen: open,
    toggle: toggleSidebar,
    contentClassName: "p-0",
    onClosed: onClose,
    className: "".concat(route ? "modal-xl" : "modal-md", " modal-dialog-centered"),
    children: [/*#__PURE__*/(0,jsx_runtime.jsx)(ModalHeader/* default */.Z, {
      className: "mb-1",
      toggle: toggleSidebar,
      close: /*#__PURE__*/(0,jsx_runtime.jsx)(x/* default */.Z, {
        className: "cursor-pointer",
        size: 15,
        onClick: toggleSidebar
      }),
      tag: "div",
      children: /*#__PURE__*/(0,jsx_runtime.jsx)("h5", {
        className: "modal-title",
        children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
          id: "".concat(schedule.id ? "edit" : "add", "Schedule")
        })
      })
    }), /*#__PURE__*/(0,jsx_runtime.jsxs)(ModalBody/* default */.Z, {
      className: "flex-grow-1 pb-sm-0 pb-3",
      children: [error && /*#__PURE__*/(0,jsx_runtime.jsxs)(Alert/* default */.Z, {
        color: "danger",
        className: "d-flex align-items-center",
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
          className: "alert-body font-small-2 flex-grow-1",
          children: /*#__PURE__*/(0,jsx_runtime.jsx)("p", {
            children: /*#__PURE__*/(0,jsx_runtime.jsx)("small", {
              className: "mr-50",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: error
              })
            })
          })
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(alert_octagon/* default */.Z, {
          id: "login-tip",
          className: "mx-50",
          size: 18,
          style: {
            top: "10px",
            right: "10px"
          }
        })]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Form/* default */.Z, {
        onSubmit: schedule.id ? onUpdate : onCreate,
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
          className: "w-100 d-flex align-items-center justify-content-center",
          children: /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
            md: route ? 6 : 12,
            children: /*#__PURE__*/(0,jsx_runtime.jsx)(RouteSelect/* default */.Z, {
              acc: schedule.id ? {
                value: schedule.route,
                label: schedule.routeName
              } : null,
              disabled: !!schedule.id,
              requireStar: true,
              invalid: submitted && !route,
              invalidText: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "required"
              }),
              refresh: true,
              dispatch: dispatch,
              onChange: function onChange(e) {
                return onRouteChange(e);
              }
            })
          })
        }), route && /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
            className: "divider",
            children: /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
              className: "divider-text",
              children: /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
                className: "full-width d-flex align-items-center justify-content-center my-1",
                children: [/*#__PURE__*/(0,jsx_runtime.jsx)(clock/* default */.Z, {
                  size: 14
                }), /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
                  className: "align-middle mx-25",
                  children: intl.formatMessage({
                    id: "schedules"
                  })
                })]
              })
            })
          }), (schedules || []).map(function (t, i) {
            var _schedules$i, _schedules$i2, _schedules$i3;

            return /*#__PURE__*/(0,jsx_runtime.jsxs)(Row/* default */.Z, {
              children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
                md: 4,
                children: /*#__PURE__*/(0,jsx_runtime.jsx)(customComponents_CarSelect, {
                  add: true,
                  acc: {
                    value: schedules[i].car,
                    label: schedules[i].carName
                  },
                  requireStar: true,
                  invalid: submitted && !schedules[i].car,
                  invalidText: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                    id: "required"
                  }),
                  refresh: true,
                  dispatch: dispatch,
                  onChange: function onChange(e) {
                    return handleCar(i, e === null || e === void 0 ? void 0 : e.value, e === null || e === void 0 ? void 0 : e.label);
                  }
                })
              }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
                md: 4,
                children: /*#__PURE__*/(0,jsx_runtime.jsx)(customComponents_DriverSelect, {
                  acc: {
                    value: schedules[i].driver,
                    label: schedules[i].driverName
                  },
                  requireStar: true,
                  invalid: submitted && !schedules[i].driver,
                  invalidText: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                    id: "required"
                  }),
                  refresh: true,
                  dispatch: dispatch,
                  onChange: function onChange(e) {
                    return handleDriver(i, e === null || e === void 0 ? void 0 : e.value, e === null || e === void 0 ? void 0 : e.label);
                  }
                })
              }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
                md: 2,
                children: /*#__PURE__*/(0,jsx_runtime.jsxs)(Field/* default */.Z, {
                  prepend: {
                    icon: /*#__PURE__*/(0,jsx_runtime.jsx)(calendar/* default */.Z, {
                      size: 14
                    })
                  },
                  type: "select",
                  isClearable: false,
                  label: intl.formatMessage({
                    id: "day"
                  }),
                  theme: Utils/* selectThemeColors */.ss,
                  invalid: submitted && !((_schedules$i = schedules[i]) !== null && _schedules$i !== void 0 && _schedules$i.day),
                  requireStar: true,
                  invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                    id: "required"
                  }),
                  value: (_schedules$i2 = schedules[i]) === null || _schedules$i2 === void 0 ? void 0 : _schedules$i2.day,
                  onChange: function onChange(e) {
                    return handleDay(i, e.target.value);
                  },
                  children: [/*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: ""
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "sunday",
                    children: intl.formatMessage({
                      id: "sunday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "monday",
                    children: intl.formatMessage({
                      id: "monday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "tuesday",
                    children: intl.formatMessage({
                      id: "tuesday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "wednesday",
                    children: intl.formatMessage({
                      id: "wednesday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "thursday",
                    children: intl.formatMessage({
                      id: "thursday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "friday",
                    children: intl.formatMessage({
                      id: "friday"
                    })
                  }), /*#__PURE__*/(0,jsx_runtime.jsx)("option", {
                    value: "saturday",
                    children: intl.formatMessage({
                      id: "saturday"
                    })
                  })]
                })
              }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
                md: 2,
                children: /*#__PURE__*/(0,jsx_runtime.jsxs)("div", {
                  className: "d-flex align-items-center justify-content-start",
                  children: [/*#__PURE__*/(0,jsx_runtime.jsx)("div", {
                    className: "flex-grow-1",
                    children: /*#__PURE__*/(0,jsx_runtime.jsx)(Field/* default */.Z, {
                      label: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                        id: "stopTime"
                      }),
                      id: "time",
                      name: "time",
                      className: "form-control",
                      onChange: function onChange(date) {
                        return handleTime(i, date[0]);
                      },
                      value: (0,esm_typeof/* default */.Z)(schedules[i].time) === "object" ? schedules[i].time : getDate(schedules[i].time),
                      invalid: submitted && !((_schedules$i3 = schedules[i]) !== null && _schedules$i3 !== void 0 && _schedules$i3.time),
                      requireStar: true,
                      invalidtext: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                        id: "required"
                      }),
                      options: {
                        enableTime: true,
                        noCalendar: true,
                        dateFormat: "H:i"
                      },
                      prepend: {
                        icon: /*#__PURE__*/(0,jsx_runtime.jsx)(clock/* default */.Z, {
                          size: 14
                        })
                      },
                      type: "flatPicker"
                    })
                  }), !schedule.id && /*#__PURE__*/(0,jsx_runtime.jsx)(x_circle/* default */.Z, {
                    onClick: function onClick() {
                      return deleteSchedule(i);
                    },
                    className: "ml-50 text-danger cursor-pointer",
                    size: 24
                  })]
                })
              })]
            }, i);
          }), !schedule.id && /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
            className: "full-width d-flex align-items-center justify-content-center my-1",
            children: /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default.Ripple */.Z.Ripple, {
              className: "round center mr-50",
              color: "success",
              onClick: function onClick() {
                return setSchedules([].concat((0,toConsumableArray/* default */.Z)(schedules), [{
                  id: new Date().getTime(),
                  day: "",
                  time: "",
                  car: "",
                  driver: ""
                }]));
              },
              children: [/*#__PURE__*/(0,jsx_runtime.jsx)("span", {
                className: "align-middle mx-25",
                children: intl.formatMessage({
                  id: "addSchedule"
                })
              }), /*#__PURE__*/(0,jsx_runtime.jsx)(plus/* default */.Z, {
                size: 14
              })]
            })
          })]
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(FormGroup/* default */.Z, {
          className: "d-flex align-items-center",
          children: /*#__PURE__*/(0,jsx_runtime.jsxs)(react.Fragment, {
            children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
              className: "mt-2",
              type: "submit",
              color: "primary",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "save"
              })
            }), schedule.id && /*#__PURE__*/(0,jsx_runtime.jsx)(Button/* default.Ripple */.Z.Ripple, {
              onClick: onDeleteSchedule,
              className: "mt-2 mx-1",
              outline: true,
              color: "danger",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "delete"
              })
            })]
          })
        })]
      })]
    })]
  });
};

/* harmony default export */ var list_Sidebar = (Sidebar);
// EXTERNAL MODULE: ./src/views/customComponents/SessionSelect.js
var SessionSelect = __webpack_require__(54615);
// EXTERNAL MODULE: ./node_modules/react-to-print/lib/index.js
var lib = __webpack_require__(47116);
// EXTERNAL MODULE: ./src/views/apps/schedule/list/TimeTable.js
var TimeTable = __webpack_require__(72579);
// EXTERNAL MODULE: ./src/views/apps/schedule/list/scheduleDetails.js
var scheduleDetails = __webpack_require__(96184);
;// CONCATENATED MODULE: ./src/views/apps/schedule/list/Table.js




function Table_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function Table_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? Table_ownKeys(Object(source), !0).forEach(function (key) { (0,defineProperty/* default */.Z)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : Table_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }


// ** React Imports
 // ** Invoice List Sidebar
// ** Columns
// ** Store & Actions

 // ** Third Party Components


 // ** Styles






















var CustomHeader = function CustomHeader(_ref) {
  var onAdd = _ref.onAdd,
      print = _ref.print,
      ability = _ref.ability;
  return /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
    className: "list-table-header w-90 mr-1 ml-50 mt-2 mb-75",
    children: /*#__PURE__*/(0,jsx_runtime.jsxs)(Row/* default */.Z, {
      children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
        xl: "3",
        className: "d-flex align-items-center p-0"
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Col/* default */.Z, {
        xl: "9",
        className: "d-flex align-items-sm-center justify-content-lg-end justify-content-start flex-lg-nowrap flex-wrap flex-sm-row flex-column pr-lg-1 p-0 mt-lg-0 mt-1",
        children: [ability.can(actions/* ACTIONS.SEE_ACTION */.a.SEE_ACTION, subjects/* SUBJECTS.PRINT_SUBJECT */.k.PRINT_SUBJECT) && /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
          className: "mr-1",
          children: /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default.Ripple */.Z.Ripple, {
            outline: true,
            color: "dark",
            onClick: print,
            children: [/*#__PURE__*/(0,jsx_runtime.jsx)(printer/* default */.Z, {
              size: 15
            }), /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
              className: "align-middle ml-25",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
                id: "print"
              })
            })]
          })
        }), ability.can(actions/* ACTIONS.WRITE_ACTION */.a.WRITE_ACTION, subjects/* SUBJECTS.SCHEDULE_SUBJECT */.k.SCHEDULE_SUBJECT) && /*#__PURE__*/(0,jsx_runtime.jsxs)(Button/* default.Ripple */.Z.Ripple, {
          color: "primary",
          onClick: onAdd,
          children: [/*#__PURE__*/(0,jsx_runtime.jsx)(plus/* default */.Z, {
            size: 15
          }), /*#__PURE__*/(0,jsx_runtime.jsx)("span", {
            className: "align-middle ml-25",
            children: /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
              id: "addSchedule"
            })
          })]
        })]
      })]
    })
  });
};

var TimeList = function TimeList() {
  var ability = (0,react.useContext)(Can/* AbilityContext */.v);

  var _useState = (0,react.useState)(Number.MAX_SAFE_INTEGER),
      _useState2 = (0,slicedToArray/* default */.Z)(_useState, 2),
      pageSize = _useState2[0],
      setPageSize = _useState2[1];

  var _useState3 = (0,react.useState)(1),
      _useState4 = (0,slicedToArray/* default */.Z)(_useState3, 2),
      pageIndex = _useState4[0],
      setPageIndex = _useState4[1];

  var _useState5 = (0,react.useState)([["createdAt", "DESC"]]),
      _useState6 = (0,slicedToArray/* default */.Z)(_useState5, 2),
      order = _useState6[0],
      setOrder = _useState6[1];

  var _useState7 = (0,react.useState)({
    count: 0,
    rows: []
  }),
      _useState8 = (0,slicedToArray/* default */.Z)(_useState7, 2),
      data = _useState8[0],
      setData = _useState8[1];

  var _useState9 = (0,react.useState)({}),
      _useState10 = (0,slicedToArray/* default */.Z)(_useState9, 2),
      schedule = _useState10[0],
      setSchedule = _useState10[1];

  var dispatch = (0,es/* useDispatch */.I0)();

  var _useState11 = (0,react.useState)(""),
      _useState12 = (0,slicedToArray/* default */.Z)(_useState11, 2),
      searchTerm = _useState12[0],
      setSearchTerm = _useState12[1];

  var _useState13 = (0,react.useState)(false),
      _useState14 = (0,slicedToArray/* default */.Z)(_useState13, 2),
      sidebarOpen = _useState14[0],
      setSidebarOpen = _useState14[1];

  var _useState15 = (0,react.useState)(false),
      _useState16 = (0,slicedToArray/* default */.Z)(_useState15, 2),
      detailsOpen = _useState16[0],
      setDetailsOpen = _useState16[1];

  var _useState17 = (0,react.useState)(0),
      _useState18 = (0,slicedToArray/* default */.Z)(_useState17, 2),
      timer = _useState18[0],
      setTimer = _useState18[1];

  var intl = (0,useIntl/* default */.Z)();

  var _useState19 = (0,react.useState)({}),
      _useState20 = (0,slicedToArray/* default */.Z)(_useState19, 2),
      filter = _useState20[0],
      setFilter = _useState20[1];

  var _useState21 = (0,react.useState)(null),
      _useState22 = (0,slicedToArray/* default */.Z)(_useState21, 2),
      teacher = _useState22[0],
      setTeacher = _useState22[1];

  var _useState23 = (0,react.useState)(null),
      _useState24 = (0,slicedToArray/* default */.Z)(_useState23, 2),
      session = _useState24[0],
      setSession = _useState24[1];

  var _useState25 = (0,react.useState)(null),
      _useState26 = (0,slicedToArray/* default */.Z)(_useState25, 2),
      student = _useState26[0],
      setStudent = _useState26[1];

  var _useState27 = (0,react.useState)(null),
      _useState28 = (0,slicedToArray/* default */.Z)(_useState27, 2),
      route = _useState28[0],
      setRoute = _useState28[1];

  var _useState29 = (0,react.useState)(false),
      _useState30 = (0,slicedToArray/* default */.Z)(_useState29, 2),
      filterOpen = _useState30[0],
      setFilterOpen = _useState30[1];

  var _useSkin = (0,useSkin/* useSkin */.Q)(),
      _useSkin2 = (0,slicedToArray/* default */.Z)(_useSkin, 1),
      skin = _useSkin2[0];

  var handlePrint = (0,lib.useReactToPrint)({
    content: function content() {
      return document.getElementById("contentZ");
    }
  });

  var handleData = function handleData(res) {
    setData({
      rows: res || [],
      count: res.length ? res[0].count : 0
    });
  };

  var getData = function getData(pageIndex, pageSize, order, filter) {
    (0,utlis/* apiCall */.k_)(utlis/* getAllPaged */.Ki, [api_urls/* SCHEDULES_URL */.g1, pageIndex, pageSize, order, filter], true, react_toastify_esm/* toast */.Am, dispatch, null, "somethingWrong", handleData, null);
  };

  var getCurrentSession = function getCurrentSession() {
    (0,utlis/* apiCall */.k_)(utlis/* getAllPaged */.Ki, [api_urls/* SESSIONS_URL */.IP, pageIndex, pageSize, order, {
      active: true
    }], true, react_toastify_esm/* toast */.Am, dispatch, null, "somethingWrong", onCurrentSessionSuccess, null);
  };

  var onCurrentSessionSuccess = function onCurrentSessionSuccess(res) {
    var currentSession = res.length ? res[0] : null;

    if (currentSession) {
      setSession({
        value: currentSession.id,
        label: currentSession.name
      });
    }

    var f = currentSession ? {
      session: currentSession.id
    } : {};
    getData(pageIndex, pageSize, order, f);
  };

  (0,react.useEffect)( /*#__PURE__*/(0,asyncToGenerator/* default */.Z)( /*#__PURE__*/regenerator_default().mark(function _callee() {
    return regenerator_default().wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            getCurrentSession();

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })), []);

  var toggleSidebar = function toggleSidebar() {
    return setSidebarOpen(!sidebarOpen);
  };

  var toggleDetails = function toggleDetails() {
    return setDetailsOpen(!detailsOpen);
  };

  var handleDriver = function handleDriver(val) {
    setPageIndex(1);
    setTeacher(val);
    setFilter(Table_objectSpread(Table_objectSpread({}, filter), {}, {
      driver: val
    }));
    clearTimeout(timer);
    setTimer(setTimeout(function () {
      return getData(1, pageSize, order, Table_objectSpread(Table_objectSpread({}, filter), {}, {
        driver: val
      }));
    }, 700));
  };

  var handleStudent = function handleStudent(val) {
    setPageIndex(1);
    setStudent(val);
    setFilter(Table_objectSpread(Table_objectSpread({}, filter), {}, {
      student: val
    }));
    clearTimeout(timer);
    setTimer(setTimeout(function () {
      return getData(1, pageSize, order, Table_objectSpread(Table_objectSpread({}, filter), {}, {
        student: val
      }));
    }, 700));
  };

  var handleCar = function handleCar(val) {
    setPageIndex(1);
    setStudent(val);
    setFilter(Table_objectSpread(Table_objectSpread({}, filter), {}, {
      car: val
    }));
    clearTimeout(timer);
    setTimer(setTimeout(function () {
      return getData(1, pageSize, order, Table_objectSpread(Table_objectSpread({}, filter), {}, {
        car: val
      }));
    }, 700));
  };

  var handleRoute = function handleRoute(val) {
    setPageIndex(1);
    setRoute(val);
    setFilter(Table_objectSpread(Table_objectSpread({}, filter), {}, {
      route: val === null || val === void 0 ? void 0 : val.value
    }));
    clearTimeout(timer);
    setTimer(setTimeout(function () {
      return getData(1, pageSize, order, Table_objectSpread(Table_objectSpread({}, filter), {}, {
        route: val
      }));
    }, 700));
  };

  var handleSession = function handleSession(val) {
    setPageIndex(1);
    setSession(val);
    setFilter(Table_objectSpread(Table_objectSpread({}, filter), {}, {
      session: val === null || val === void 0 ? void 0 : val.value
    }));
    clearTimeout(timer);
    setTimer(setTimeout(function () {
      return getData(1, pageSize, order, Table_objectSpread(Table_objectSpread({}, filter), {}, {
        session: val === null || val === void 0 ? void 0 : val.value
      }));
    }, 700));
  };

  var editSchedule = function editSchedule(s) {
    setSchedule(s);
    toggleSidebar();
  };

  var viewSchedule = function viewSchedule(s) {
    setSchedule(s);
    toggleDetails();
  };

  var onSideClosed = function onSideClosed() {
    return setSchedule({});
  };

  var onAdd = function onAdd() {
    setSidebarOpen(true);
  };

  var onScheduleClicked = function onScheduleClicked(s) {
    setSchedule(s);
    setDetailsOpen(true);
  };

  return /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
    className: "app-expense-list",
    children: /*#__PURE__*/(0,jsx_runtime.jsxs)(react.Fragment, {
      children: [/*#__PURE__*/(0,jsx_runtime.jsxs)(Card/* default */.Z, {
        children: [/*#__PURE__*/(0,jsx_runtime.jsxs)(CardHeader/* default */.Z, {
          className: "cursor-pointer",
          onClick: function onClick() {
            return setFilterOpen(!filterOpen);
          },
          children: [/*#__PURE__*/(0,jsx_runtime.jsxs)(CardTitle/* default */.Z, {
            tag: "h4",
            children: [/*#__PURE__*/(0,jsx_runtime.jsx)(icons_filter/* default */.Z, {
              className: "mr-1 text-dark"
            }), /*#__PURE__*/(0,jsx_runtime.jsx)(message/* default */.Z, {
              id: "searchFilter"
            })]
          }), !filterOpen ? /*#__PURE__*/(0,jsx_runtime.jsx)(chevron_down/* default */.Z, {}) : /*#__PURE__*/(0,jsx_runtime.jsx)(chevron_up/* default */.Z, {})]
        }), filterOpen && /*#__PURE__*/(0,jsx_runtime.jsx)(CardBody/* default */.Z, {
          children: /*#__PURE__*/(0,jsx_runtime.jsxs)(Row/* default */.Z, {
            children: [/*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
              md: "3",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(SessionSelect/* default */.Z, {
                acc: session,
                refresh: true,
                label: false,
                dispatch: dispatch,
                onChange: function onChange(e) {
                  return handleSession(e);
                }
              })
            }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
              md: "3",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(customComponents_DriverSelect, {
                refresh: true,
                label: false,
                dispatch: dispatch,
                onChange: function onChange(e) {
                  return handleDriver(e === null || e === void 0 ? void 0 : e.value);
                }
              })
            }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
              md: "3",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(RouteSelect/* default */.Z, {
                refresh: true,
                label: false,
                dispatch: dispatch,
                onChange: function onChange(e) {
                  return handleRoute(e === null || e === void 0 ? void 0 : e.value);
                }
              })
            }), /*#__PURE__*/(0,jsx_runtime.jsx)(Col/* default */.Z, {
              md: "3",
              children: /*#__PURE__*/(0,jsx_runtime.jsx)(customComponents_CarSelect, {
                refresh: true,
                label: false,
                dispatch: dispatch,
                onChange: function onChange(e) {
                  return handleCar(e === null || e === void 0 ? void 0 : e.value);
                }
              })
            })]
          })
        })]
      }), /*#__PURE__*/(0,jsx_runtime.jsxs)(Card/* default */.Z, {
        children: [/*#__PURE__*/(0,jsx_runtime.jsx)(CustomHeader, {
          ability: ability,
          pageIndex: pageIndex,
          onAdd: onAdd,
          print: handlePrint // handlePerPage={handlePerPage}
          ,
          rowsPerPage: pageSize // handleFilter={handleFilter}
          ,
          data: data,
          intl: intl
        }), /*#__PURE__*/(0,jsx_runtime.jsx)(TimeTable/* default */.Z, {
          editSchedule: onScheduleClicked,
          list: data.rows || []
        })]
      }), /*#__PURE__*/(0,jsx_runtime.jsx)(scheduleDetails/* default */.Z, {
        onClosed: onSideClosed,
        dispatch: dispatch,
        openDetails: detailsOpen,
        toggleDetails: toggleDetails,
        toggleSidebar: toggleSidebar,
        refresh: getCurrentSession,
        schedule: schedule.id
      }), /*#__PURE__*/(0,jsx_runtime.jsx)(list_Sidebar, {
        dispatch: dispatch,
        open: sidebarOpen,
        toggleSidebar: toggleSidebar,
        onClosed: onSideClosed,
        refresh: getCurrentSession,
        schedule: schedule
      })]
    })
  });
};

/* harmony default export */ var Table = (TimeList);
;// CONCATENATED MODULE: ./src/views/apps/schedule/list/index.js
// ** User List Component
// ** Styles





var List = function List() {
  return /*#__PURE__*/(0,jsx_runtime.jsx)("div", {
    className: "app-user-list",
    children: /*#__PURE__*/(0,jsx_runtime.jsx)(Table, {})
  });
};

/* harmony default export */ var list = (List);

/***/ }),

/***/ 15538:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(87462);
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(63366);
/* harmony import */ var _babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(97326);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(45697);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(94184);
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(23663);








var propTypes = {
  children: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().node),
  inline: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool),
  tag: _utils__WEBPACK_IMPORTED_MODULE_3__/* .tagPropType */ .iC,
  innerRef: prop_types__WEBPACK_IMPORTED_MODULE_2___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_2___default().object), (prop_types__WEBPACK_IMPORTED_MODULE_2___default().func), (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string)]),
  className: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().string),
  cssModule: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().object)
};
var defaultProps = {
  tag: 'form'
};

var Form = /*#__PURE__*/function (_Component) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(Form, _Component);

  function Form(props) {
    var _this;

    _this = _Component.call(this, props) || this;
    _this.getRef = _this.getRef.bind((0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(_this));
    _this.submit = _this.submit.bind((0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(_this));
    return _this;
  }

  var _proto = Form.prototype;

  _proto.getRef = function getRef(ref) {
    if (this.props.innerRef) {
      this.props.innerRef(ref);
    }

    this.ref = ref;
  };

  _proto.submit = function submit() {
    if (this.ref) {
      this.ref.submit();
    }
  };

  _proto.render = function render() {
    var _this$props = this.props,
        className = _this$props.className,
        cssModule = _this$props.cssModule,
        inline = _this$props.inline,
        Tag = _this$props.tag,
        innerRef = _this$props.innerRef,
        attributes = (0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(_this$props, ["className", "cssModule", "inline", "tag", "innerRef"]);

    var classes = (0,_utils__WEBPACK_IMPORTED_MODULE_3__/* .mapToCssModules */ .mx)(classnames__WEBPACK_IMPORTED_MODULE_1___default()(className, inline ? 'form-inline' : false), cssModule);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Tag, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)({}, attributes, {
      ref: innerRef,
      className: classes
    }));
  };

  return Form;
}(react__WEBPACK_IMPORTED_MODULE_0__.Component);

Form.propTypes = propTypes;
Form.defaultProps = defaultProps;
/* harmony default export */ __webpack_exports__["Z"] = (Form);

/***/ })

}]);